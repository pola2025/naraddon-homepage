version: '3.8'

services:
  app:
    image: mcr.microsoft.com/devcontainers/universal:linux
    volumes:
      - ..:/workspaces:cached
    # 'app' 서비스에 Node.js Feature를 적용
    features:
      ghcr.io/devcontainers/features/node:1:
        version: "18"
    user: codespace # 이 부분을 추가하여 devcontainer.json의 remoteUser와 일치시킵니다.
    command: /bin/sh -c "while sleep 1000; do :; done"
    ports:
      - "3000:3000"
      - "5000:5000"

  db:
    image: mongo:6.0
    restart: unless-stopped
    volumes:
      - dbdata:/data/db
    ports:
      - "27017:27017"
    # db 서비스에는 user를 명시적으로 지정하지 않습니다. mongo 이미지의 기본 유저를 따릅니다.

volumes:
  dbdata: